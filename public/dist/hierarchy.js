import{r as i,R as B,j as x,d as wn}from"./client.js";import{r as je}from"./index.js";function xn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.useMemo(()=>r=>{t.forEach(o=>o(r))},t)}const et=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Se(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function vt(e){return"nodeType"in e}function $(e){var t,n;return e?Se(e)?e:vt(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function pt(e){const{Document:t}=$(e);return e instanceof t}function Xe(e){return Se(e)?!1:e instanceof $(e).HTMLElement}function Wt(e){return e instanceof $(e).SVGElement}function Ee(e){return e?Se(e)?e.document:vt(e)?pt(e)?e:Xe(e)||Wt(e)?e.ownerDocument:document:document:document}const te=et?i.useLayoutEffect:i.useEffect;function bt(e){const t=i.useRef(e);return te(()=>{t.current=e}),i.useCallback(function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return t.current==null?void 0:t.current(...r)},[])}function Dn(){const e=i.useRef(null),t=i.useCallback((r,o)=>{e.current=setInterval(r,o)},[]),n=i.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function Be(e,t){t===void 0&&(t=[e]);const n=i.useRef(e);return te(()=>{n.current!==e&&(n.current=e)},t),n}function Ye(e,t){const n=i.useRef();return i.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function qe(e){const t=bt(e),n=i.useRef(null),r=i.useCallback(o=>{o!==n.current&&t?.(o,n.current),n.current=o},[]);return[n,r]}function ut(e){const t=i.useRef();return i.useEffect(()=>{t.current=e},[e]),t.current}let it={};function He(e,t){return i.useMemo(()=>{if(t)return t;const n=it[e]==null?0:it[e]+1;return it[e]=n,e+"-"+n},[e,t])}function Kt(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.reduce((s,a)=>{const l=Object.entries(a);for(const[c,u]of l){const d=s[c];d!=null&&(s[c]=d+e*u)}return s},{...t})}}const Re=Kt(1),_e=Kt(-1);function Cn(e){return"clientX"in e&&"clientY"in e}function mt(e){if(!e)return!1;const{KeyboardEvent:t}=$(e.target);return t&&e instanceof t}function Rn(e){if(!e)return!1;const{TouchEvent:t}=$(e.target);return t&&e instanceof t}function dt(e){if(Rn(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return Cn(e)?{x:e.clientX,y:e.clientY}:null}const Fe=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Fe.Translate.toString(e),Fe.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),Tt="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Sn(e){return e.matches(Tt)?e:e.querySelector(Tt)}const En={display:"none"};function Mn(e){let{id:t,value:n}=e;return B.createElement("div",{id:t,style:En},n)}function Nn(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const o={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return B.createElement("div",{id:t,style:o,role:"status","aria-live":r,"aria-atomic":!0},n)}function In(){const[e,t]=i.useState("");return{announce:i.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const Gt=i.createContext(null);function An(e){const t=i.useContext(Gt);i.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function On(){const[e]=i.useState(()=>new Set),t=i.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[i.useCallback(r=>{let{type:o,event:s}=r;e.forEach(a=>{var l;return(l=a[o])==null?void 0:l.call(a,s)})},[e]),t]}const Tn={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Ln={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function jn(e){let{announcements:t=Ln,container:n,hiddenTextDescribedById:r,screenReaderInstructions:o=Tn}=e;const{announce:s,announcement:a}=In(),l=He("DndLiveRegion"),[c,u]=i.useState(!1);if(i.useEffect(()=>{u(!0)},[]),An(i.useMemo(()=>({onDragStart(f){let{active:b}=f;s(t.onDragStart({active:b}))},onDragMove(f){let{active:b,over:v}=f;t.onDragMove&&s(t.onDragMove({active:b,over:v}))},onDragOver(f){let{active:b,over:v}=f;s(t.onDragOver({active:b,over:v}))},onDragEnd(f){let{active:b,over:v}=f;s(t.onDragEnd({active:b,over:v}))},onDragCancel(f){let{active:b,over:v}=f;s(t.onDragCancel({active:b,over:v}))}}),[s,t])),!c)return null;const d=B.createElement(B.Fragment,null,B.createElement(Mn,{id:r,value:o.draggable}),B.createElement(Nn,{id:l,announcement:a}));return n?je.createPortal(d,n):d}var T;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(T||(T={}));function Qe(){}function kn(e,t){return i.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function Pn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const _=Object.freeze({x:0,y:0});function zn(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Bn(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function Fn(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function $n(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function Lt(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const Xn=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=Lt(t,t.left,t.top),s=[];for(const a of r){const{id:l}=a,c=n.get(l);if(c){const u=zn(Lt(c),o);s.push({id:l,data:{droppableContainer:a,value:u}})}}return s.sort(Bn)};function Yn(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),o=Math.min(t.left+t.width,e.left+e.width),s=Math.min(t.top+t.height,e.top+e.height),a=o-r,l=s-n;if(r<o&&n<s){const c=t.width*t.height,u=e.width*e.height,d=a*l,f=d/(c+u-d);return Number(f.toFixed(4))}return 0}const Hn=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const o=[];for(const s of r){const{id:a}=s,l=n.get(a);if(l){const c=Yn(l,t);c>0&&o.push({id:a,data:{droppableContainer:s,value:c}})}}return o.sort(Fn)};function Un(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function Vt(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:_}function Wn(e){return function(n){for(var r=arguments.length,o=new Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];return o.reduce((a,l)=>({...a,top:a.top+e*l.y,bottom:a.bottom+e*l.y,left:a.left+e*l.x,right:a.right+e*l.x}),{...n})}}const Kn=Wn(1);function Gn(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function Vn(e,t,n){const r=Gn(t);if(!r)return e;const{scaleX:o,scaleY:s,x:a,y:l}=r,c=e.left-a-(1-o)*parseFloat(n),u=e.top-l-(1-s)*parseFloat(n.slice(n.indexOf(" ")+1)),d=o?e.width/o:e.width,f=s?e.height/s:e.height;return{width:d,height:f,top:u,right:c+d,bottom:u+f,left:c}}const Jn={ignoreTransform:!1};function Me(e,t){t===void 0&&(t=Jn);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:d}=$(e).getComputedStyle(e);u&&(n=Vn(n,u,d))}const{top:r,left:o,width:s,height:a,bottom:l,right:c}=n;return{top:r,left:o,width:s,height:a,bottom:l,right:c}}function jt(e){return Me(e,{ignoreTransform:!0})}function qn(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function _n(e,t){return t===void 0&&(t=$(e).getComputedStyle(e)),t.position==="fixed"}function Qn(e,t){t===void 0&&(t=$(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(o=>{const s=t[o];return typeof s=="string"?n.test(s):!1})}function yt(e,t){const n=[];function r(o){if(t!=null&&n.length>=t||!o)return n;if(pt(o)&&o.scrollingElement!=null&&!n.includes(o.scrollingElement))return n.push(o.scrollingElement),n;if(!Xe(o)||Wt(o)||n.includes(o))return n;const s=$(e).getComputedStyle(o);return o!==e&&Qn(o,s)&&n.push(o),_n(o,s)?n:r(o.parentNode)}return e?r(e):n}function Jt(e){const[t]=yt(e,1);return t??null}function at(e){return!et||!e?null:Se(e)?e:vt(e)?pt(e)||e===Ee(e).scrollingElement?window:Xe(e)?e:null:null}function qt(e){return Se(e)?e.scrollX:e.scrollLeft}function _t(e){return Se(e)?e.scrollY:e.scrollTop}function ft(e){return{x:qt(e),y:_t(e)}}var k;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(k||(k={}));function Qt(e){return!et||!e?!1:e===document.scrollingElement}function Zt(e){const t={x:0,y:0},n=Qt(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},o=e.scrollTop<=t.y,s=e.scrollLeft<=t.x,a=e.scrollTop>=r.y,l=e.scrollLeft>=r.x;return{isTop:o,isLeft:s,isBottom:a,isRight:l,maxScroll:r,minScroll:t}}const Zn={x:.2,y:.2};function er(e,t,n,r,o){let{top:s,left:a,right:l,bottom:c}=n;r===void 0&&(r=10),o===void 0&&(o=Zn);const{isTop:u,isBottom:d,isLeft:f,isRight:b}=Zt(e),v={x:0,y:0},A={x:0,y:0},m={height:t.height*o.y,width:t.width*o.x};return!u&&s<=t.top+m.height?(v.y=k.Backward,A.y=r*Math.abs((t.top+m.height-s)/m.height)):!d&&c>=t.bottom-m.height&&(v.y=k.Forward,A.y=r*Math.abs((t.bottom-m.height-c)/m.height)),!b&&l>=t.right-m.width?(v.x=k.Forward,A.x=r*Math.abs((t.right-m.width-l)/m.width)):!f&&a<=t.left+m.width&&(v.x=k.Backward,A.x=r*Math.abs((t.left+m.width-a)/m.width)),{direction:v,speed:A}}function tr(e){if(e===document.scrollingElement){const{innerWidth:s,innerHeight:a}=window;return{top:0,left:0,right:s,bottom:a,width:s,height:a}}const{top:t,left:n,right:r,bottom:o}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:o,width:e.clientWidth,height:e.clientHeight}}function en(e){return e.reduce((t,n)=>Re(t,ft(n)),_)}function nr(e){return e.reduce((t,n)=>t+qt(n),0)}function rr(e){return e.reduce((t,n)=>t+_t(n),0)}function or(e,t){if(t===void 0&&(t=Me),!e)return;const{top:n,left:r,bottom:o,right:s}=t(e);Jt(e)&&(o<=0||s<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const sr=[["x",["left","right"],nr],["y",["top","bottom"],rr]];class wt{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=yt(n),o=en(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[s,a,l]of sr)for(const c of a)Object.defineProperty(this,c,{get:()=>{const u=l(r),d=o[s]-u;return this.rect[c]+d},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class ke{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var o;(o=this.target)==null||o.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function ir(e){const{EventTarget:t}=$(e);return e instanceof t?e:Ee(e)}function lt(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var J;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(J||(J={}));function kt(e){e.preventDefault()}function ar(e){e.stopPropagation()}var I;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(I||(I={}));const tn={start:[I.Space,I.Enter],cancel:[I.Esc],end:[I.Space,I.Enter,I.Tab]},lr=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case I.Right:return{...n,x:n.x+25};case I.Left:return{...n,x:n.x-25};case I.Down:return{...n,y:n.y+25};case I.Up:return{...n,y:n.y-25}}};class nn{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new ke(Ee(n)),this.windowListeners=new ke($(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(J.Resize,this.handleCancel),this.windowListeners.add(J.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(J.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&or(r),n(_)}handleKeyDown(t){if(mt(t)){const{active:n,context:r,options:o}=this.props,{keyboardCodes:s=tn,coordinateGetter:a=lr,scrollBehavior:l="smooth"}=o,{code:c}=t;if(s.end.includes(c)){this.handleEnd(t);return}if(s.cancel.includes(c)){this.handleCancel(t);return}const{collisionRect:u}=r.current,d=u?{x:u.left,y:u.top}:_;this.referenceCoordinates||(this.referenceCoordinates=d);const f=a(t,{active:n,context:r.current,currentCoordinates:d});if(f){const b=_e(f,d),v={x:0,y:0},{scrollableAncestors:A}=r.current;for(const m of A){const y=t.code,{isTop:C,isRight:R,isLeft:D,isBottom:E,maxScroll:M,minScroll:g}=Zt(m),h=tr(m),p={x:Math.min(y===I.Right?h.right-h.width/2:h.right,Math.max(y===I.Right?h.left:h.left+h.width/2,f.x)),y:Math.min(y===I.Down?h.bottom-h.height/2:h.bottom,Math.max(y===I.Down?h.top:h.top+h.height/2,f.y))},w=y===I.Right&&!R||y===I.Left&&!D,N=y===I.Down&&!E||y===I.Up&&!C;if(w&&p.x!==f.x){const S=m.scrollLeft+b.x,L=y===I.Right&&S<=M.x||y===I.Left&&S>=g.x;if(L&&!b.y){m.scrollTo({left:S,behavior:l});return}L?v.x=m.scrollLeft-S:v.x=y===I.Right?m.scrollLeft-M.x:m.scrollLeft-g.x,v.x&&m.scrollBy({left:-v.x,behavior:l});break}else if(N&&p.y!==f.y){const S=m.scrollTop+b.y,L=y===I.Down&&S<=M.y||y===I.Up&&S>=g.y;if(L&&!b.x){m.scrollTo({top:S,behavior:l});return}L?v.y=m.scrollTop-S:v.y=y===I.Down?m.scrollTop-M.y:m.scrollTop-g.y,v.y&&m.scrollBy({top:-v.y,behavior:l});break}}this.handleMove(t,Re(_e(f,this.referenceCoordinates),v))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}nn.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=tn,onActivation:o}=t,{active:s}=n;const{code:a}=e.nativeEvent;if(r.start.includes(a)){const l=s.activatorNode.current;return l&&e.target!==l?!1:(e.preventDefault(),o?.({event:e.nativeEvent}),!0)}return!1}}];function Pt(e){return!!(e&&"distance"in e)}function zt(e){return!!(e&&"delay"in e)}class xt{constructor(t,n,r){var o;r===void 0&&(r=ir(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:s}=t,{target:a}=s;this.props=t,this.events=n,this.document=Ee(a),this.documentListeners=new ke(this.document),this.listeners=new ke(r),this.windowListeners=new ke($(a)),this.initialCoordinates=(o=dt(s))!=null?o:_,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(J.Resize,this.handleCancel),this.windowListeners.add(J.DragStart,kt),this.windowListeners.add(J.VisibilityChange,this.handleCancel),this.windowListeners.add(J.ContextMenu,kt),this.documentListeners.add(J.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(zt(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(Pt(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:o}=this.props;o(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(J.Click,ar,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(J.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:o,props:s}=this,{onMove:a,options:{activationConstraint:l}}=s;if(!o)return;const c=(n=dt(t))!=null?n:_,u=_e(o,c);if(!r&&l){if(Pt(l)){if(l.tolerance!=null&&lt(u,l.tolerance))return this.handleCancel();if(lt(u,l.distance))return this.handleStart()}if(zt(l)&&lt(u,l.tolerance))return this.handleCancel();this.handlePending(l,u);return}t.cancelable&&t.preventDefault(),a(c)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===I.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const cr={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Dt extends xt{constructor(t){const{event:n}=t,r=Ee(n.target);super(t,cr,r)}}Dt.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r?.({event:n}),!0)}}];const ur={move:{name:"mousemove"},end:{name:"mouseup"}};var ht;(function(e){e[e.RightClick=2]="RightClick"})(ht||(ht={}));class dr extends xt{constructor(t){super(t,ur,Ee(t.event.target))}}dr.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===ht.RightClick?!1:(r?.({event:n}),!0)}}];const ct={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class fr extends xt{constructor(t){super(t,ct)}static setup(){return window.addEventListener(ct.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(ct.move.name,t)};function t(){}}}fr.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:o}=n;return o.length>1?!1:(r?.({event:n}),!0)}}];var Pe;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Pe||(Pe={}));var Ze;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Ze||(Ze={}));function hr(e){let{acceleration:t,activator:n=Pe.Pointer,canScroll:r,draggingRect:o,enabled:s,interval:a=5,order:l=Ze.TreeOrder,pointerCoordinates:c,scrollableAncestors:u,scrollableAncestorRects:d,delta:f,threshold:b}=e;const v=vr({delta:f,disabled:!s}),[A,m]=Dn(),y=i.useRef({x:0,y:0}),C=i.useRef({x:0,y:0}),R=i.useMemo(()=>{switch(n){case Pe.Pointer:return c?{top:c.y,bottom:c.y,left:c.x,right:c.x}:null;case Pe.DraggableRect:return o}},[n,o,c]),D=i.useRef(null),E=i.useCallback(()=>{const g=D.current;if(!g)return;const h=y.current.x*C.current.x,p=y.current.y*C.current.y;g.scrollBy(h,p)},[]),M=i.useMemo(()=>l===Ze.TreeOrder?[...u].reverse():u,[l,u]);i.useEffect(()=>{if(!s||!u.length||!R){m();return}for(const g of M){if(r?.(g)===!1)continue;const h=u.indexOf(g),p=d[h];if(!p)continue;const{direction:w,speed:N}=er(g,p,R,t,b);for(const S of["x","y"])v[S][w[S]]||(N[S]=0,w[S]=0);if(N.x>0||N.y>0){m(),D.current=g,A(E,a),y.current=N,C.current=w;return}}y.current={x:0,y:0},C.current={x:0,y:0},m()},[t,E,r,m,s,a,JSON.stringify(R),JSON.stringify(v),A,u,M,d,JSON.stringify(b)])}const gr={x:{[k.Backward]:!1,[k.Forward]:!1},y:{[k.Backward]:!1,[k.Forward]:!1}};function vr(e){let{delta:t,disabled:n}=e;const r=ut(t);return Ye(o=>{if(n||!r||!o)return gr;const s={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[k.Backward]:o.x[k.Backward]||s.x===-1,[k.Forward]:o.x[k.Forward]||s.x===1},y:{[k.Backward]:o.y[k.Backward]||s.y===-1,[k.Forward]:o.y[k.Forward]||s.y===1}}},[n,t,r])}function pr(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return Ye(o=>{var s;return t==null?null:(s=r??o)!=null?s:null},[r,t])}function br(e,t){return i.useMemo(()=>e.reduce((n,r)=>{const{sensor:o}=r,s=o.activators.map(a=>({eventName:a.eventName,handler:t(a.handler,r)}));return[...n,...s]},[]),[e,t])}var $e;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})($e||($e={}));var gt;(function(e){e.Optimized="optimized"})(gt||(gt={}));const Bt=new Map;function mr(e,t){let{dragging:n,dependencies:r,config:o}=t;const[s,a]=i.useState(null),{frequency:l,measure:c,strategy:u}=o,d=i.useRef(e),f=y(),b=Be(f),v=i.useCallback(function(C){C===void 0&&(C=[]),!b.current&&a(R=>R===null?C:R.concat(C.filter(D=>!R.includes(D))))},[b]),A=i.useRef(null),m=Ye(C=>{if(f&&!n)return Bt;if(!C||C===Bt||d.current!==e||s!=null){const R=new Map;for(let D of e){if(!D)continue;if(s&&s.length>0&&!s.includes(D.id)&&D.rect.current){R.set(D.id,D.rect.current);continue}const E=D.node.current,M=E?new wt(c(E),E):null;D.rect.current=M,M&&R.set(D.id,M)}return R}return C},[e,s,n,f,c]);return i.useEffect(()=>{d.current=e},[e]),i.useEffect(()=>{f||v()},[n,f]),i.useEffect(()=>{s&&s.length>0&&a(null)},[JSON.stringify(s)]),i.useEffect(()=>{f||typeof l!="number"||A.current!==null||(A.current=setTimeout(()=>{v(),A.current=null},l))},[l,f,v,...r]),{droppableRects:m,measureDroppableContainers:v,measuringScheduled:s!=null};function y(){switch(u){case $e.Always:return!1;case $e.BeforeDragging:return n;default:return!n}}}function rn(e,t){return Ye(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function yr(e,t){return rn(e,t)}function wr(e){let{callback:t,disabled:n}=e;const r=bt(t),o=i.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:s}=window;return new s(r)},[r,n]);return i.useEffect(()=>()=>o?.disconnect(),[o]),o}function tt(e){let{callback:t,disabled:n}=e;const r=bt(t),o=i.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:s}=window;return new s(r)},[n]);return i.useEffect(()=>()=>o?.disconnect(),[o]),o}function xr(e){return new wt(Me(e),e)}function Ft(e,t,n){t===void 0&&(t=xr);const[r,o]=i.useState(null);function s(){o(c=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=c??n)!=null?u:null}const d=t(e);return JSON.stringify(c)===JSON.stringify(d)?c:d})}const a=wr({callback(c){if(e)for(const u of c){const{type:d,target:f}=u;if(d==="childList"&&f instanceof HTMLElement&&f.contains(e)){s();break}}}}),l=tt({callback:s});return te(()=>{s(),e?(l?.observe(e),a?.observe(document.body,{childList:!0,subtree:!0})):(l?.disconnect(),a?.disconnect())},[e]),r}function Dr(e){const t=rn(e);return Vt(e,t)}const $t=[];function Cr(e){const t=i.useRef(e),n=Ye(r=>e?r&&r!==$t&&e&&t.current&&e.parentNode===t.current.parentNode?r:yt(e):$t,[e]);return i.useEffect(()=>{t.current=e},[e]),n}function Rr(e){const[t,n]=i.useState(null),r=i.useRef(e),o=i.useCallback(s=>{const a=at(s.target);a&&n(l=>l?(l.set(a,ft(a)),new Map(l)):null)},[]);return i.useEffect(()=>{const s=r.current;if(e!==s){a(s);const l=e.map(c=>{const u=at(c);return u?(u.addEventListener("scroll",o,{passive:!0}),[u,ft(u)]):null}).filter(c=>c!=null);n(l.length?new Map(l):null),r.current=e}return()=>{a(e),a(s)};function a(l){l.forEach(c=>{const u=at(c);u?.removeEventListener("scroll",o)})}},[o,e]),i.useMemo(()=>e.length?t?Array.from(t.values()).reduce((s,a)=>Re(s,a),_):en(e):_,[e,t])}function Xt(e,t){t===void 0&&(t=[]);const n=i.useRef(null);return i.useEffect(()=>{n.current=null},t),i.useEffect(()=>{const r=e!==_;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?_e(e,n.current):_}function Sr(e){i.useEffect(()=>{if(!et)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n?.()}},e.map(t=>{let{sensor:n}=t;return n}))}function Er(e,t){return i.useMemo(()=>e.reduce((n,r)=>{let{eventName:o,handler:s}=r;return n[o]=a=>{s(a,t)},n},{}),[e,t])}function on(e){return i.useMemo(()=>e?qn(e):null,[e])}const Yt=[];function Mr(e,t){t===void 0&&(t=Me);const[n]=e,r=on(n?$(n):null),[o,s]=i.useState(Yt);function a(){s(()=>e.length?e.map(c=>Qt(c)?r:new wt(t(c),c)):Yt)}const l=tt({callback:a});return te(()=>{l?.disconnect(),a(),e.forEach(c=>l?.observe(c))},[e]),o}function Nr(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Xe(t)?t:e}function Ir(e){let{measure:t}=e;const[n,r]=i.useState(null),o=i.useCallback(u=>{for(const{target:d}of u)if(Xe(d)){r(f=>{const b=t(d);return f?{...f,width:b.width,height:b.height}:b});break}},[t]),s=tt({callback:o}),a=i.useCallback(u=>{const d=Nr(u);s?.disconnect(),d&&s?.observe(d),r(d?t(d):null)},[t,s]),[l,c]=qe(a);return i.useMemo(()=>({nodeRef:l,rect:n,setRef:c}),[n,l,c])}const Ar=[{sensor:Dt,options:{}},{sensor:nn,options:{}}],Or={current:{}},Je={draggable:{measure:jt},droppable:{measure:jt,strategy:$e.WhileDragging,frequency:gt.Optimized},dragOverlay:{measure:Me}};class ze extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const Tr={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new ze,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Qe},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Je,measureDroppableContainers:Qe,windowRect:null,measuringScheduled:!1},Lr={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Qe,draggableNodes:new Map,over:null,measureDroppableContainers:Qe},nt=i.createContext(Lr),sn=i.createContext(Tr);function jr(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new ze}}}function kr(e,t){switch(t.type){case T.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case T.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case T.DragEnd:case T.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case T.RegisterDroppable:{const{element:n}=t,{id:r}=n,o=new ze(e.droppable.containers);return o.set(r,n),{...e,droppable:{...e.droppable,containers:o}}}case T.SetDroppableDisabled:{const{id:n,key:r,disabled:o}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const a=new ze(e.droppable.containers);return a.set(n,{...s,disabled:o}),{...e,droppable:{...e.droppable,containers:a}}}case T.UnregisterDroppable:{const{id:n,key:r}=t,o=e.droppable.containers.get(n);if(!o||r!==o.key)return e;const s=new ze(e.droppable.containers);return s.delete(n),{...e,droppable:{...e.droppable,containers:s}}}default:return e}}function Pr(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:o}=i.useContext(nt),s=ut(r),a=ut(n?.id);return i.useEffect(()=>{if(!t&&!r&&s&&a!=null){if(!mt(s)||document.activeElement===s.target)return;const l=o.get(a);if(!l)return;const{activatorNode:c,node:u}=l;if(!c.current&&!u.current)return;requestAnimationFrame(()=>{for(const d of[c.current,u.current]){if(!d)continue;const f=Sn(d);if(f){f.focus();break}}})}},[r,t,o,a,s]),null}function zr(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((o,s)=>s({transform:o,...r}),n):n}function Br(e){return i.useMemo(()=>({draggable:{...Je.draggable,...e?.draggable},droppable:{...Je.droppable,...e?.droppable},dragOverlay:{...Je.dragOverlay,...e?.dragOverlay}}),[e?.draggable,e?.droppable,e?.dragOverlay])}function Fr(e){let{activeNode:t,measure:n,initialRect:r,config:o=!0}=e;const s=i.useRef(!1),{x:a,y:l}=typeof o=="boolean"?{x:o,y:o}:o;te(()=>{if(!a&&!l||!t){s.current=!1;return}if(s.current||!r)return;const u=t?.node.current;if(!u||u.isConnected===!1)return;const d=n(u),f=Vt(d,r);if(a||(f.x=0),l||(f.y=0),s.current=!0,Math.abs(f.x)>0||Math.abs(f.y)>0){const b=Jt(u);b&&b.scrollBy({top:f.y,left:f.x})}},[t,a,l,r,n])}const an=i.createContext({..._,scaleX:1,scaleY:1});var ve;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(ve||(ve={}));const $r=i.memo(function(t){var n,r,o,s;let{id:a,accessibility:l,autoScroll:c=!0,children:u,sensors:d=Ar,collisionDetection:f=Hn,measuring:b,modifiers:v,...A}=t;const m=i.useReducer(kr,void 0,jr),[y,C]=m,[R,D]=On(),[E,M]=i.useState(ve.Uninitialized),g=E===ve.Initialized,{draggable:{active:h,nodes:p,translate:w},droppable:{containers:N}}=y,S=h!=null?p.get(h):null,L=i.useRef({initial:null,translated:null}),X=i.useMemo(()=>{var z;return h!=null?{id:h,data:(z=S?.data)!=null?z:Or,rect:L}:null},[h,S]),W=i.useRef(null),[ae,ne]=i.useState(null),[j,le]=i.useState(null),K=Be(A,Object.values(A)),pe=He("DndDescribedBy",a),q=i.useMemo(()=>N.getEnabled(),[N]),F=Br(b),{droppableRects:re,measureDroppableContainers:be,measuringScheduled:Ne}=mr(q,{dragging:g,dependencies:[w.x,w.y],config:F.droppable}),G=pr(p,h),Ue=i.useMemo(()=>j?dt(j):null,[j]),ce=yn(),oe=yr(G,F.draggable.measure);Fr({activeNode:h!=null?p.get(h):null,config:ce.layoutShiftCompensation,initialRect:oe,measure:F.draggable.measure});const O=Ft(G,F.draggable.measure,oe),Ie=Ft(G?G.parentElement:null),Q=i.useRef({activatorEvent:null,active:null,activeNode:G,collisionRect:null,collisions:null,droppableRects:re,draggableNodes:p,draggingNode:null,draggingNodeRect:null,droppableContainers:N,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),me=N.getNodeFor((n=Q.current.over)==null?void 0:n.id),se=Ir({measure:F.dragOverlay.measure}),ye=(r=se.nodeRef.current)!=null?r:G,we=g?(o=se.rect)!=null?o:O:null,Rt=!!(se.nodeRef.current&&se.rect),St=Dr(Rt?null:O),rt=on(ye?$(ye):null),ue=Cr(g?me??G:null),We=Mr(ue),Ke=zr(v,{transform:{x:w.x-St.x,y:w.y-St.y,scaleX:1,scaleY:1},activatorEvent:j,active:X,activeNodeRect:O,containerNodeRect:Ie,draggingNodeRect:we,over:Q.current.over,overlayNodeRect:se.rect,scrollableAncestors:ue,scrollableAncestorRects:We,windowRect:rt}),Et=Ue?Re(Ue,w):null,Mt=Rr(ue),fn=Xt(Mt),hn=Xt(Mt,[O]),xe=Re(Ke,fn),De=we?Kn(we,Ke):null,Ae=X&&De?f({active:X,collisionRect:De,droppableRects:re,droppableContainers:q,pointerCoordinates:Et}):null,Nt=$n(Ae,"id"),[de,It]=i.useState(null),gn=Rt?Ke:Re(Ke,hn),vn=Un(gn,(s=de?.rect)!=null?s:null,O),ot=i.useRef(null),At=i.useCallback((z,Y)=>{let{sensor:H,options:fe}=Y;if(W.current==null)return;const V=p.get(W.current);if(!V)return;const U=z.nativeEvent,Z=new H({active:W.current,activeNode:V,event:U,options:fe,context:Q,onAbort(P){if(!p.get(P))return;const{onDragAbort:ee}=K.current,ie={id:P};ee?.(ie),R({type:"onDragAbort",event:ie})},onPending(P,he,ee,ie){if(!p.get(P))return;const{onDragPending:Te}=K.current,ge={id:P,constraint:he,initialCoordinates:ee,offset:ie};Te?.(ge),R({type:"onDragPending",event:ge})},onStart(P){const he=W.current;if(he==null)return;const ee=p.get(he);if(!ee)return;const{onDragStart:ie}=K.current,Oe={activatorEvent:U,active:{id:he,data:ee.data,rect:L}};je.unstable_batchedUpdates(()=>{ie?.(Oe),M(ve.Initializing),C({type:T.DragStart,initialCoordinates:P,active:he}),R({type:"onDragStart",event:Oe}),ne(ot.current),le(U)})},onMove(P){C({type:T.DragMove,coordinates:P})},onEnd:Ce(T.DragEnd),onCancel:Ce(T.DragCancel)});ot.current=Z;function Ce(P){return async function(){const{active:ee,collisions:ie,over:Oe,scrollAdjustedTranslate:Te}=Q.current;let ge=null;if(ee&&Te){const{cancelDrop:Le}=K.current;ge={activatorEvent:U,active:ee,collisions:ie,delta:Te,over:Oe},P===T.DragEnd&&typeof Le=="function"&&await Promise.resolve(Le(ge))&&(P=T.DragCancel)}W.current=null,je.unstable_batchedUpdates(()=>{C({type:P}),M(ve.Uninitialized),It(null),ne(null),le(null),ot.current=null;const Le=P===T.DragEnd?"onDragEnd":"onDragCancel";if(ge){const st=K.current[Le];st?.(ge),R({type:Le,event:ge})}})}}},[p]),pn=i.useCallback((z,Y)=>(H,fe)=>{const V=H.nativeEvent,U=p.get(fe);if(W.current!==null||!U||V.dndKit||V.defaultPrevented)return;const Z={active:U};z(H,Y.options,Z)===!0&&(V.dndKit={capturedBy:Y.sensor},W.current=fe,At(H,Y))},[p,At]),Ot=br(d,pn);Sr(d),te(()=>{O&&E===ve.Initializing&&M(ve.Initialized)},[O,E]),i.useEffect(()=>{const{onDragMove:z}=K.current,{active:Y,activatorEvent:H,collisions:fe,over:V}=Q.current;if(!Y||!H)return;const U={active:Y,activatorEvent:H,collisions:fe,delta:{x:xe.x,y:xe.y},over:V};je.unstable_batchedUpdates(()=>{z?.(U),R({type:"onDragMove",event:U})})},[xe.x,xe.y]),i.useEffect(()=>{const{active:z,activatorEvent:Y,collisions:H,droppableContainers:fe,scrollAdjustedTranslate:V}=Q.current;if(!z||W.current==null||!Y||!V)return;const{onDragOver:U}=K.current,Z=fe.get(Nt),Ce=Z&&Z.rect.current?{id:Z.id,rect:Z.rect.current,data:Z.data,disabled:Z.disabled}:null,P={active:z,activatorEvent:Y,collisions:H,delta:{x:V.x,y:V.y},over:Ce};je.unstable_batchedUpdates(()=>{It(Ce),U?.(P),R({type:"onDragOver",event:P})})},[Nt]),te(()=>{Q.current={activatorEvent:j,active:X,activeNode:G,collisionRect:De,collisions:Ae,droppableRects:re,draggableNodes:p,draggingNode:ye,draggingNodeRect:we,droppableContainers:N,over:de,scrollableAncestors:ue,scrollAdjustedTranslate:xe},L.current={initial:we,translated:De}},[X,G,Ae,De,p,ye,we,re,N,de,ue,xe]),hr({...ce,delta:w,draggingRect:De,pointerCoordinates:Et,scrollableAncestors:ue,scrollableAncestorRects:We});const bn=i.useMemo(()=>({active:X,activeNode:G,activeNodeRect:O,activatorEvent:j,collisions:Ae,containerNodeRect:Ie,dragOverlay:se,draggableNodes:p,droppableContainers:N,droppableRects:re,over:de,measureDroppableContainers:be,scrollableAncestors:ue,scrollableAncestorRects:We,measuringConfiguration:F,measuringScheduled:Ne,windowRect:rt}),[X,G,O,j,Ae,Ie,se,p,N,re,de,be,ue,We,F,Ne,rt]),mn=i.useMemo(()=>({activatorEvent:j,activators:Ot,active:X,activeNodeRect:O,ariaDescribedById:{draggable:pe},dispatch:C,draggableNodes:p,over:de,measureDroppableContainers:be}),[j,Ot,X,O,C,pe,p,de,be]);return B.createElement(Gt.Provider,{value:D},B.createElement(nt.Provider,{value:mn},B.createElement(sn.Provider,{value:bn},B.createElement(an.Provider,{value:vn},u)),B.createElement(Pr,{disabled:l?.restoreFocus===!1})),B.createElement(jn,{...l,hiddenTextDescribedById:pe}));function yn(){const z=ae?.autoScrollEnabled===!1,Y=typeof c=="object"?c.enabled===!1:c===!1,H=g&&!z&&!Y;return typeof c=="object"?{...c,enabled:H}:{enabled:H}}}),Xr=i.createContext(null),Ht="button",Yr="Draggable";function Hr(e){let{id:t,data:n,disabled:r=!1,attributes:o}=e;const s=He(Yr),{activators:a,activatorEvent:l,active:c,activeNodeRect:u,ariaDescribedById:d,draggableNodes:f,over:b}=i.useContext(nt),{role:v=Ht,roleDescription:A="draggable",tabIndex:m=0}=o??{},y=c?.id===t,C=i.useContext(y?an:Xr),[R,D]=qe(),[E,M]=qe(),g=Er(a,t),h=Be(n);te(()=>(f.set(t,{id:t,key:s,node:R,activatorNode:E,data:h}),()=>{const w=f.get(t);w&&w.key===s&&f.delete(t)}),[f,t]);const p=i.useMemo(()=>({role:v,tabIndex:m,"aria-disabled":r,"aria-pressed":y&&v===Ht?!0:void 0,"aria-roledescription":A,"aria-describedby":d.draggable}),[r,v,m,y,A,d.draggable]);return{active:c,activatorEvent:l,activeNodeRect:u,attributes:p,isDragging:y,listeners:r?void 0:g,node:R,over:b,setNodeRef:D,setActivatorNodeRef:M,transform:C}}function Ur(){return i.useContext(sn)}const Wr="Droppable",Kr={timeout:25};function Gr(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:o}=e;const s=He(Wr),{active:a,dispatch:l,over:c,measureDroppableContainers:u}=i.useContext(nt),d=i.useRef({disabled:n}),f=i.useRef(!1),b=i.useRef(null),v=i.useRef(null),{disabled:A,updateMeasurementsFor:m,timeout:y}={...Kr,...o},C=Be(m??r),R=i.useCallback(()=>{if(!f.current){f.current=!0;return}v.current!=null&&clearTimeout(v.current),v.current=setTimeout(()=>{u(Array.isArray(C.current)?C.current:[C.current]),v.current=null},y)},[y]),D=tt({callback:R,disabled:A||!a}),E=i.useCallback((p,w)=>{D&&(w&&(D.unobserve(w),f.current=!1),p&&D.observe(p))},[D]),[M,g]=qe(E),h=Be(t);return i.useEffect(()=>{!D||!M.current||(D.disconnect(),f.current=!1,D.observe(M.current))},[M,D]),i.useEffect(()=>(l({type:T.RegisterDroppable,element:{id:r,key:s,disabled:n,node:M,rect:b,data:h}}),()=>l({type:T.UnregisterDroppable,key:s,id:r})),[r]),i.useEffect(()=>{n!==d.current.disabled&&(l({type:T.SetDroppableDisabled,id:r,key:s,disabled:n}),d.current.disabled=n)},[r,s,n,l]),{active:a,rect:b,isOver:c?.id===r,node:M,over:c,setNodeRef:g}}function Ct(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function Vr(e,t){return e.reduce((n,r,o)=>{const s=t.get(r);return s&&(n[o]=s),n},Array(e.length))}function Ge(e){return e!==null&&e>=0}function Jr(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function qr(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const ln=e=>{let{rects:t,activeIndex:n,overIndex:r,index:o}=e;const s=Ct(t,r,n),a=t[o],l=s[o];return!l||!a?null:{x:l.left-a.left,y:l.top-a.top,scaleX:l.width/a.width,scaleY:l.height/a.height}},Ve={scaleX:1,scaleY:1},_r=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:o,rects:s,overIndex:a}=e;const l=(t=s[n])!=null?t:r;if(!l)return null;if(o===n){const u=s[a];return u?{x:0,y:n<a?u.top+u.height-(l.top+l.height):u.top-l.top,...Ve}:null}const c=Qr(s,o,n);return o>n&&o<=a?{x:0,y:-l.height-c,...Ve}:o<n&&o>=a?{x:0,y:l.height+c,...Ve}:{x:0,y:0,...Ve}};function Qr(e,t,n){const r=e[t],o=e[t-1],s=e[t+1];return r?n<t?o?r.top-(o.top+o.height):s?s.top-(r.top+r.height):0:s?s.top-(r.top+r.height):o?r.top-(o.top+o.height):0:0}const cn="Sortable",un=B.createContext({activeIndex:-1,containerId:cn,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:ln,disabled:{draggable:!1,droppable:!1}});function Zr(e){let{children:t,id:n,items:r,strategy:o=ln,disabled:s=!1}=e;const{active:a,dragOverlay:l,droppableRects:c,over:u,measureDroppableContainers:d}=Ur(),f=He(cn,n),b=l.rect!==null,v=i.useMemo(()=>r.map(g=>typeof g=="object"&&"id"in g?g.id:g),[r]),A=a!=null,m=a?v.indexOf(a.id):-1,y=u?v.indexOf(u.id):-1,C=i.useRef(v),R=!Jr(v,C.current),D=y!==-1&&m===-1||R,E=qr(s);te(()=>{R&&A&&d(v)},[R,v,A,d]),i.useEffect(()=>{C.current=v},[v]);const M=i.useMemo(()=>({activeIndex:m,containerId:f,disabled:E,disableTransforms:D,items:v,overIndex:y,useDragOverlay:b,sortedRects:Vr(v,c),strategy:o}),[m,f,E.draggable,E.droppable,D,v,y,c,b,o]);return B.createElement(un.Provider,{value:M},t)}const eo=e=>{let{id:t,items:n,activeIndex:r,overIndex:o}=e;return Ct(n,r,o).indexOf(t)},to=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:o,items:s,newIndex:a,previousItems:l,previousContainerId:c,transition:u}=e;return!u||!r||l!==s&&o===a?!1:n?!0:a!==o&&t===c},no={duration:200,easing:"ease"},dn="transform",ro=Fe.Transition.toString({property:dn,duration:0,easing:"linear"}),oo={roleDescription:"sortable"};function so(e){let{disabled:t,index:n,node:r,rect:o}=e;const[s,a]=i.useState(null),l=i.useRef(n);return te(()=>{if(!t&&n!==l.current&&r.current){const c=o.current;if(c){const u=Me(r.current,{ignoreTransform:!0}),d={x:c.left-u.left,y:c.top-u.top,scaleX:c.width/u.width,scaleY:c.height/u.height};(d.x||d.y)&&a(d)}}n!==l.current&&(l.current=n)},[t,n,r,o]),i.useEffect(()=>{s&&a(null)},[s]),s}function io(e){let{animateLayoutChanges:t=to,attributes:n,disabled:r,data:o,getNewIndex:s=eo,id:a,strategy:l,resizeObserverConfig:c,transition:u=no}=e;const{items:d,containerId:f,activeIndex:b,disabled:v,disableTransforms:A,sortedRects:m,overIndex:y,useDragOverlay:C,strategy:R}=i.useContext(un),D=ao(r,v),E=d.indexOf(a),M=i.useMemo(()=>({sortable:{containerId:f,index:E,items:d},...o}),[f,o,E,d]),g=i.useMemo(()=>d.slice(d.indexOf(a)),[d,a]),{rect:h,node:p,isOver:w,setNodeRef:N}=Gr({id:a,data:M,disabled:D.droppable,resizeObserverConfig:{updateMeasurementsFor:g,...c}}),{active:S,activatorEvent:L,activeNodeRect:X,attributes:W,setNodeRef:ae,listeners:ne,isDragging:j,over:le,setActivatorNodeRef:K,transform:pe}=Hr({id:a,data:M,attributes:{...oo,...n},disabled:D.draggable}),q=xn(N,ae),F=!!S,re=F&&!A&&Ge(b)&&Ge(y),be=!C&&j,Ne=be&&re?pe:null,Ue=re?Ne??(l??R)({rects:m,activeNodeRect:X,activeIndex:b,overIndex:y,index:E}):null,ce=Ge(b)&&Ge(y)?s({id:a,items:d,activeIndex:b,overIndex:y}):E,oe=S?.id,O=i.useRef({activeId:oe,items:d,newIndex:ce,containerId:f}),Ie=d!==O.current.items,Q=t({active:S,containerId:f,isDragging:j,isSorting:F,id:a,index:E,items:d,newIndex:O.current.newIndex,previousItems:O.current.items,previousContainerId:O.current.containerId,transition:u,wasDragging:O.current.activeId!=null}),me=so({disabled:!Q,index:E,node:p,rect:h});return i.useEffect(()=>{F&&O.current.newIndex!==ce&&(O.current.newIndex=ce),f!==O.current.containerId&&(O.current.containerId=f),d!==O.current.items&&(O.current.items=d)},[F,ce,f,d]),i.useEffect(()=>{if(oe===O.current.activeId)return;if(oe&&!O.current.activeId){O.current.activeId=oe;return}const ye=setTimeout(()=>{O.current.activeId=oe},50);return()=>clearTimeout(ye)},[oe]),{active:S,activeIndex:b,attributes:W,data:M,rect:h,index:E,newIndex:ce,items:d,isOver:w,isSorting:F,isDragging:j,listeners:ne,node:p,overIndex:y,over:le,setNodeRef:q,setActivatorNodeRef:K,setDroppableNodeRef:N,setDraggableNodeRef:ae,transform:me??Ue,transition:se()};function se(){if(me||Ie&&O.current.newIndex===E)return ro;if(!(be&&!mt(L)||!u)&&(F||Q))return Fe.Transition.toString({...u,property:dn})}}function ao(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e?.draggable)!=null?n:t.draggable,droppable:(r=e?.droppable)!=null?r:t.droppable}}I.Down,I.Right,I.Up,I.Left;function lo(){const[e,t]=i.useState([]),[n,r]=i.useState([]),[o,s]=i.useState({}),[a,l]=i.useState(""),[c,u]=i.useState(!0),[d,f]=i.useState({});i.useEffect(()=>{async function g(){try{const[h,p,w]=await Promise.all([fetch("/api/hierarchy"),fetch("/api/permissions"),fetch("/api/modules")]),N=await h.json(),S=await p.json(),L=await w.json();t(N.hierarchy||[]),s(S.permissions||{}),Array.isArray(L.groups)?r(L.groups):Array.isArray(L.modules)?r([{category:"modules",modules:L.modules}]):r([])}catch(h){console.error(h)}}g()},[]),i.useEffect(()=>{e.length&&!a&&l(e[0])},[e,a]);const b=async g=>{t(g);try{await fetch("/api/hierarchy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({hierarchy:g})})}catch(h){console.error(h)}},v=async g=>{s(g);try{await fetch("/api/permissions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({permissions:g})})}catch(h){console.error(h)}},A=g=>{g.preventDefault();const h=g.target.role.value.trim();if(!h||e.includes(h))return;const p=[...e,h];b(p),s(w=>({...w,[h]:[]})),g.target.reset()},m=Pn(kn(Dt,{activationConstraint:{distance:5}})),y=g=>{const{active:h,over:p}=g;if(p&&h.id!==p.id){const w=e.indexOf(h.id),N=e.indexOf(p.id),S=Ct(e,w,N);b(S)}},C=(g,h)=>{const p=e[g];if(!p||!h||e.includes(h))return;const w=e.slice();w[g]=h;const N={...o};N[p]&&(N[h]=N[p],delete N[p]),b(w),v(N),a===p&&l(h)},R=g=>{if(g===e.length-1){alert("Cannot remove the highest role");return}if(!window.confirm("Remove this role?"))return;const h=e[g],p=e.filter((N,S)=>S!==g),w={...o};delete w[h],b(p),v(w),a===h&&l(p[0]||"")},D=(g,h)=>{const p=new Set(o[g]||[]);p.has(h)?p.delete(h):p.add(h),v({...o,[g]:Array.from(p)})},E=g=>{f(h=>({...h,[g]:!h[g]}))},M=({id:g,index:h,highest:p})=>{const{attributes:w,listeners:N,setNodeRef:S,transform:L,transition:X}=io({id:g}),W={transform:Fe.Transform.toString(L),transition:X},[ae,ne]=i.useState(!1),[j,le]=i.useState(g),K=()=>{ne(!1),j.trim()&&j.trim()!==g?C(h,j.trim()):le(g)},pe=q=>{q.key==="Enter"?(q.preventDefault(),K()):q.key==="Escape"&&(q.preventDefault(),le(g),ne(!1))};return x.jsxs("div",{ref:S,style:W,className:`role-card${g===a?" selected":""}`,onClick:()=>l(g),children:[x.jsxs("div",{className:"d-flex align-items-center flex-grow-1",children:[x.jsx("span",{className:"drag-handle me-2",...w,...N,children:x.jsx("i",{className:"bi bi-grip-vertical"})}),ae?x.jsx("input",{className:"form-control form-control-sm edit-input me-2",value:j,onChange:q=>le(q.target.value),onBlur:K,onKeyDown:pe,autoFocus:!0}):x.jsxs("span",{className:"role-name flex-grow-1",onDoubleClick:()=>ne(!0),children:[g,p&&x.jsx("span",{className:"badge bg-success ms-2",children:"Highest"})]})]}),x.jsxs("div",{className:"d-flex align-items-center ms-2",children:[!ae&&x.jsx("button",{className:"btn btn-sm btn-link p-0 me-2",onClick:()=>ne(!0),"aria-label":"Rename",children:x.jsx("i",{className:"bi bi-pencil"})}),x.jsx("button",{className:"delete-btn",onClick:()=>R(h),"aria-label":"Delete",children:x.jsx("i",{className:"bi bi-trash"})})]})]})};return x.jsxs("div",{className:"hierarchy-wrapper",children:[x.jsxs("div",{className:"roles-panel",children:[x.jsx("h5",{children:"Roles"}),x.jsx("p",{className:"text-muted small",children:"Order roles from lowest to highest privilege. The last role has access to everything."}),x.jsx($r,{sensors:m,collisionDetection:Xn,onDragEnd:y,children:x.jsx(Zr,{items:e,strategy:_r,children:x.jsx("div",{className:"roles-list mb-2",children:e.map((g,h)=>x.jsx(M,{id:g,index:h,highest:h===e.length-1},g))})})}),x.jsxs("form",{onSubmit:A,className:"d-flex",children:[x.jsx("input",{type:"text",name:"role",className:"form-control form-control-sm me-2",placeholder:"New role"}),x.jsx("button",{type:"submit",className:"btn btn-sm btn-primary",children:"Add"})]})]}),x.jsxs("div",{className:"modules-panel",children:[x.jsxs("h5",{className:"d-flex align-items-center",children:["Module Access",x.jsx("button",{type:"button",className:"btn btn-link btn-sm ms-2 module-toggle",onClick:()=>u(!c),children:c?"Show":"Hide"})]}),!c&&a&&x.jsx("div",{children:n.map((g,h)=>{const p=d[h];return x.jsxs("div",{className:"module-group mb-3",children:[x.jsx("button",{type:"button",className:"btn btn-link btn-sm arrow-toggle",onClick:()=>E(h),children:x.jsx("i",{className:`bi ${p?"bi-caret-right":"bi-caret-down"}`})}),x.jsx("span",{className:"ms-1 fw-semibold",children:g.category}),!p&&x.jsx("ul",{className:"list-group mt-2",children:g.modules.map(w=>x.jsxs("li",{className:"list-group-item d-flex justify-content-between align-items-center",children:[x.jsx("span",{children:w.replace(/-/g," ")}),x.jsx("div",{className:"form-check form-switch",children:x.jsx("input",{className:"form-check-input",type:"checkbox",checked:(o[a]||[]).includes(w),onChange:()=>D(a,w)})})]},w))})]},g.category||h)})})]})]})}function Ut(){const e=document.getElementById("hierarchyApp");e&&wn.createRoot(e).render(x.jsx(B.StrictMode,{children:x.jsx(lo,{})}))}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",Ut,{once:!0}):Ut();
