import{r as o,j as e,e as C,R as S}from"./client.js";function E(){const r={first_name:"",last_name:"",position:"",start_date:"",email:"",phone:"",wage_rate:"",username:"",password:"",pin:"",role:""},[i,N]=o.useState([]),[d,p]=o.useState([]),[a,m]=o.useState(r),[l,x]=o.useState(-1),[u,v]=o.useState("");o.useEffect(()=>{async function s(){try{const[t,c]=await Promise.all([fetch("/api/employees"),fetch("/api/hierarchy")]),h=await t.json(),f=await c.json();p(h.employees||[]),N(f.hierarchy||[]),m(_=>({..._,role:(f.hierarchy||[])[0]||""}))}catch(t){console.error(t)}}s()},[]);const j=()=>{m(s=>({...r,role:i[0]||""})),x(-1)},n=s=>{const{name:t,value:c}=s.target;m(h=>({...h,[t]:c}))},g=async s=>{s.preventDefault();const t=[...d];l>=0?t[l]={...t[l],...a}:t.push({...a,id:Date.now()}),p(t),j();try{await fetch("/api/employees",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({employees:t})})}catch(c){console.error(c)}},b=s=>{const t=d[s];t&&(x(s),m({first_name:t.first_name||"",last_name:t.last_name||"",position:t.position||"",start_date:t.start_date||"",email:t.email||"",phone:t.phone||"",wage_rate:t.wage_rate||"",username:t.username||"",password:"",pin:"",role:t.role||i[0]||""}))},w=d.filter(s=>{const t=u.toLowerCase();return s.first_name&&s.first_name.toLowerCase().includes(t)||s.last_name&&s.last_name.toLowerCase().includes(t)||s.position&&s.position.toLowerCase().includes(t)||s.role&&s.role.toLowerCase().includes(t)});return e.jsxs("div",{children:[e.jsxs("form",{onSubmit:g,className:"mb-4",children:[e.jsxs("div",{className:"row g-2 mb-3",children:[e.jsx("div",{className:"col-sm-3",children:e.jsx("input",{type:"text",name:"first_name",value:a.first_name,onChange:n,className:"form-control form-control-sm",placeholder:"First Name"})}),e.jsx("div",{className:"col-sm-3",children:e.jsx("input",{type:"text",name:"last_name",value:a.last_name,onChange:n,className:"form-control form-control-sm",placeholder:"Last Name"})}),e.jsx("div",{className:"col-sm-3",children:e.jsx("input",{type:"text",name:"position",value:a.position,onChange:n,className:"form-control form-control-sm",placeholder:"Position"})}),e.jsx("div",{className:"col-sm-3",children:e.jsx("input",{type:"date",name:"start_date",value:a.start_date,onChange:n,className:"form-control form-control-sm"})})]}),e.jsxs("div",{className:"row g-2 mb-3",children:[e.jsx("div",{className:"col-sm-3",children:e.jsx("input",{type:"email",name:"email",value:a.email,onChange:n,className:"form-control form-control-sm",placeholder:"Email"})}),e.jsx("div",{className:"col-sm-3",children:e.jsx("input",{type:"text",name:"phone",value:a.phone,onChange:n,className:"form-control form-control-sm",placeholder:"Phone"})}),e.jsx("div",{className:"col-sm-3",children:e.jsx("input",{type:"number",step:"0.01",name:"wage_rate",value:a.wage_rate,onChange:n,className:"form-control form-control-sm",placeholder:"Wage Rate"})}),e.jsx("div",{className:"col-sm-3",children:e.jsx("input",{type:"text",name:"username",value:a.username,onChange:n,className:"form-control form-control-sm",placeholder:"Username"})})]}),e.jsxs("div",{className:"row g-2 mb-3",children:[e.jsx("div",{className:"col-sm-4",children:e.jsx("input",{type:"password",name:"password",value:a.password,onChange:n,className:"form-control form-control-sm",placeholder:"Password",autoComplete:"new-password"})}),e.jsx("div",{className:"col-sm-4",children:e.jsx("input",{type:"password",name:"pin",value:a.pin,onChange:n,className:"form-control form-control-sm",placeholder:"PIN (4-6 digits)",autoComplete:"new-password",pattern:"\\d{4,6}"})}),e.jsx("div",{className:"col-sm-4",children:e.jsx("select",{name:"role",value:a.role,onChange:n,className:"form-select form-select-sm",children:i.map(s=>e.jsx("option",{value:s,children:s},s))})})]}),e.jsx("button",{type:"submit",className:"btn btn-primary btn-sm",children:l>=0?"Update":"Save"}),l>=0&&e.jsx("button",{type:"button",className:"btn btn-secondary btn-sm ms-2",onClick:j,children:"Cancel"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("h5",{children:"Current Employees"}),e.jsx("input",{type:"text",value:u,onChange:s=>v(s.target.value),className:"form-control form-control-sm mb-2",placeholder:"Search employees"}),e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"First"}),e.jsx("th",{children:"Last"}),e.jsx("th",{children:"Position"}),e.jsx("th",{children:"Start"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Phone"}),e.jsx("th",{children:"Wage"}),e.jsx("th",{children:"Username"}),e.jsx("th",{children:"Role"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:w.map((s,t)=>e.jsxs("tr",{children:[e.jsx("td",{children:s.first_name}),e.jsx("td",{children:s.last_name}),e.jsx("td",{children:s.position}),e.jsx("td",{children:s.start_date}),e.jsx("td",{children:s.email}),e.jsx("td",{children:s.phone}),e.jsx("td",{children:s.wage_rate}),e.jsx("td",{children:s.username}),e.jsx("td",{children:s.role}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-sm btn-outline-primary",onClick:()=>b(t),children:"Edit"})})]},s.id||t))})]})})]})]})}function y(){const r=document.getElementById("onboardingApp");r&&C.createRoot(r).render(e.jsx(S.StrictMode,{children:e.jsx(E,{})}))}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",y,{once:!0}):y();
