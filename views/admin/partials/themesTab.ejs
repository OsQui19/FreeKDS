  <div class="container admin-container">
  <h1>Branding & Theme</h1>
  <button class="btn btn-secondary mb-2" type="button" data-bs-toggle="collapse" data-bs-target="#themeForm">Show Settings</button>
  <div id="themeForm" class="collapse">
  <div class="row g-3">
    <div class="col-12 col-md-5">
    <form method="POST" action="/admin/settings" class="p-2">
      <ul class="nav nav-pills mb-3" id="themeTabNav" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active" id="tab-brand" data-bs-toggle="tab" data-bs-target="#pane-brand" type="button" role="tab" aria-controls="pane-brand" aria-selected="true">Brand</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tab-layout" data-bs-toggle="tab" data-bs-target="#pane-layout" type="button" role="tab" aria-controls="pane-layout" aria-selected="false">Layout</button>
        </li>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tab-type" data-bs-toggle="tab" data-bs-target="#pane-type" type="button" role="tab" aria-controls="pane-type" aria-selected="false">Typography</button>
        </li>
      </ul>
      <div class="tab-content">
        <div class="tab-pane fade show active" id="pane-brand" role="tabpanel" aria-labelledby="tab-brand">
    <div class="row mb-3">
      <label for="brand-name" class="col-sm-4 col-form-label">Brand Name:</label>
      <div class="col-sm-8">
        <input id="brand-name" class="form-control" type="text" name="brand_name" value="<%= settings.brand_name || '' %>">
      </div>
    </div>
    <div class="row mb-3">
      <label for="theme-primary-color" class="col-sm-4 col-form-label">Primary Color:</label>
      <div class="col-sm-8">
        <input id="theme-primary-color" class="form-control" type="color" name="theme_primary_color" value="<%= settings.theme_primary_color || '#3366cc' %>">
      </div>
    </div>
    <div class="row mb-3">
      <label for="theme-bg-color" class="col-sm-4 col-form-label">Background Color:</label>
      <div class="col-sm-8">
        <input id="theme-bg-color" class="form-control" type="color" name="theme_bg_color" value="<%= settings.theme_bg_color || '#222222' %>">
      </div>
    </div>
    <div class="row mb-3">
      <label for="theme-wallpaper" class="col-sm-4 col-form-label">Wallpaper URL:</label>
      <div class="col-sm-8">
        <input id="theme-wallpaper" class="form-control" type="text" name="theme_wallpaper" value="<%= settings.theme_wallpaper || '' %>">
      </div>
    </div>
    </div>
        <div class="tab-pane fade" id="pane-layout" role="tabpanel" aria-labelledby="tab-layout">
          <div class="row mb-3">
            <label for="ticket-layout" class="col-sm-4 col-form-label">Ticket Layout Columns:</label>
            <div class="col-sm-8">
              <input id="ticket-layout" class="form-control" type="number" name="ticket_layout" min="1" value="<%= settings.ticket_layout || 1 %>" data-preview="station">
            </div>
          </div>
          <div class="row mb-3">
            <label for="button-radius" class="col-sm-4 col-form-label">Button Radius:</label>
            <div class="col-sm-8">
              <input id="button-radius" class="form-control" type="number" step="1" name="button_radius" value="<%= settings.button_radius || 6 %>">
            </div>
          </div>
          <div class="row mb-3">
            <label for="card-shadow" class="col-sm-4 col-form-label">Card Shadow:</label>
            <div class="col-sm-8">
              <input id="card-shadow" class="form-control" type="text" name="card_shadow" value="<%= settings.card_shadow || '0 2px 6px rgba(0,0,0,0.08)' %>">
            </div>
          </div>
          <div class="row mb-3">
            <label for="menu-layout" class="col-sm-4 col-form-label">Menu Layout:</label>
            <div class="col-sm-8">
              <select id="menu-layout" class="form-select" name="menu_layout" data-preview="menu">
                <option value="grid" <%= settings.menu_layout !== 'list' ? 'selected' : '' %>>Grid</option>
                <option value="list" <%= settings.menu_layout === 'list' ? 'selected' : '' %>>List</option>
              </select>
            </div>
          </div>
        </div>
        <div class="tab-pane fade" id="pane-type" role="tabpanel" aria-labelledby="tab-type">
          <div class="row mb-3">
            <label for="text-color" class="col-sm-4 col-form-label">Text Color:</label>
            <div class="col-sm-8">
              <input id="text-color" class="form-control" type="color" name="text_color" value="<%= settings.text_color || '#000000' %>">
            </div>
          </div>
          <div class="row mb-3">
            <label for="font-family" class="col-sm-4 col-form-label">Font Family:</label>
            <div class="col-sm-8">
              <input id="font-family" class="form-control" list="fontOptions" type="text" name="font_family" value="<%= settings.font_family || '' %>">
              <datalist id="fontOptions">
                <option value="Inter, sans-serif">
                <option value="Arial, sans-serif">
                <option value="Georgia, serif">
                <option value="'Times New Roman', serif">
                <option value="Courier New, monospace">
              </datalist>
            </div>
          </div>
          <div class="mb-3">
            <label for="custom-css" class="form-label">Custom CSS:</label>
            <textarea id="custom-css" class="form-control" rows="4" name="custom_css"><%- settings.custom_css || '' %></textarea>
          </div>
        </div>
      </div>
      <button type="submit" class="btn btn-primary">Update Theme</button>
    </form>
    </div>
    <div class="col-12 col-md-7">
      <ul class="nav nav-tabs mb-2" id="previewTabs" role="tablist">
        <li class="nav-item" role="presentation">
          <button class="nav-link active" id="tab-menu-preview" data-bs-toggle="tab" data-bs-target="#pane-menu-preview" type="button" role="tab" aria-controls="pane-menu-preview" aria-selected="true">Menu</button>
        </li>
        <% if (stations && stations.length) { %>
        <li class="nav-item" role="presentation">
          <button class="nav-link" id="tab-station-preview" data-bs-toggle="tab" data-bs-target="#pane-station-preview" type="button" role="tab" aria-controls="pane-station-preview" aria-selected="false">Station</button>
        </li>
        <% } %>
      </ul>
      <div class="tab-content" id="previewTabContent">
        <div class="tab-pane fade show active" id="pane-menu-preview" role="tabpanel" aria-labelledby="tab-menu-preview">
          <iframe id="menuPreview" class="w-100" src="/order" title="Menu preview"></iframe>
        </div>
        <% if (stations && stations.length) { %>
        <div class="tab-pane fade" id="pane-station-preview" role="tabpanel" aria-labelledby="tab-station-preview">
          <iframe id="stationPreview" class="w-100" src="/station/<%= stations[0].id %>" title="Station preview"></iframe>
        </div>
        <% } %>
      </div>
      <div class="mt-2 text-end">
        <button type="button" id="togglePreview" class="btn btn-secondary btn-sm me-2">Hide Preview</button>
        <button type="button" id="resetPreview" class="btn btn-secondary btn-sm">Reset to Defaults</button>
      </div>
    </div>
  </div>
  </div>
<script>
  const themeForm = document.getElementById('themeForm');
  const themeToggle = document.querySelector('button[data-bs-target="#themeForm"]');
  if (themeForm && themeToggle) {
    const updateText = () => {
      themeToggle.textContent = themeForm.classList.contains('show') ? 'Hide Settings' : 'Show Settings';
    };
    updateText();
    themeForm.addEventListener('shown.bs.collapse', updateText);
    themeForm.addEventListener('hidden.bs.collapse', updateText);
  }
</script>
<script defer src="/themePreview.js"></script>
</div>
