  <div class="container admin-container">
  <h1>Branding & Theme</h1>
  <button class="btn btn-secondary mb-2" type="button" data-bs-toggle="collapse" data-bs-target="#themeForm">Show Settings</button>
  <div id="themeForm" class="collapse">
  <div class="row g-3">
    <div class="col-12 col-md-5">
    <form method="POST" action="/admin/settings" class="p-2">
    <div class="row mb-3">
      <label for="brand-name" class="col-sm-4 col-form-label">Brand Name:</label>
      <div class="col-sm-8">
        <input id="brand-name" class="form-control" type="text" name="brand_name" value="<%= settings.brand_name || '' %>">
      </div>
    </div>
    <div class="row mb-3">
      <label for="theme-primary-color" class="col-sm-4 col-form-label">Primary Color:</label>
      <div class="col-sm-8">
        <input id="theme-primary-color" class="form-control" type="color" name="theme_primary_color" value="<%= settings.theme_primary_color || '#3366cc' %>">
      </div>
    </div>
    <div class="row mb-3">
      <label for="theme-bg-color" class="col-sm-4 col-form-label">Background Color:</label>
      <div class="col-sm-8">
        <input id="theme-bg-color" class="form-control" type="color" name="theme_bg_color" value="<%= settings.theme_bg_color || '#222222' %>">
      </div>
    </div>
    <div class="row mb-3">
      <label for="ticket-layout" class="col-sm-4 col-form-label">Ticket Layout Columns:</label>
      <div class="col-sm-8">
        <input id="ticket-layout" class="form-control" type="number" name="ticket_layout" min="1" value="<%= settings.ticket_layout || 1 %>">
      </div>
    </div>
    <div class="row mb-3">
      <label for="text-color" class="col-sm-4 col-form-label">Text Color:</label>
      <div class="col-sm-8">
        <input id="text-color" class="form-control" type="color" name="text_color" value="<%= settings.text_color || '#000000' %>">
      </div>
    </div>
    <div class="row mb-3">
      <label for="button-radius" class="col-sm-4 col-form-label">Button Radius:</label>
      <div class="col-sm-8">
        <input id="button-radius" class="form-control" type="number" step="1" name="button_radius" value="<%= settings.button_radius || 6 %>">
      </div>
    </div>
    <div class="row mb-3">
      <label for="card-shadow" class="col-sm-4 col-form-label">Card Shadow:</label>
      <div class="col-sm-8">
        <input id="card-shadow" class="form-control" type="text" name="card_shadow" value="<%= settings.card_shadow || '0 2px 6px rgba(0,0,0,0.08)' %>">
      </div>
    </div>
    <div class="row mb-3">
      <label for="menu-layout" class="col-sm-4 col-form-label">Menu Layout:</label>
      <div class="col-sm-8">
        <select id="menu-layout" class="form-select" name="menu_layout">
          <option value="grid" <%= settings.menu_layout !== 'list' ? 'selected' : '' %>>Grid</option>
          <option value="list" <%= settings.menu_layout === 'list' ? 'selected' : '' %>>List</option>
        </select>
      </div>
    </div>
    <div class="row mb-3">
      <label for="font-family" class="col-sm-4 col-form-label">Font Family:</label>
      <div class="col-sm-8">
        <input id="font-family" class="form-control" list="fontOptions" type="text" name="font_family" value="<%= settings.font_family || '' %>">
        <datalist id="fontOptions">
          <option value="Inter, sans-serif">
          <option value="Arial, sans-serif">
          <option value="Georgia, serif">
          <option value="'Times New Roman', serif">
          <option value="Courier New, monospace">
        </datalist>
      </div>
    </div>
    <div class="mb-3">
      <label for="custom-css" class="form-label">Custom CSS:</label>
      <textarea id="custom-css" class="form-control" rows="4" name="custom_css"><%- settings.custom_css || '' %></textarea>
    </div>
    <button type="submit" class="btn btn-primary">Update Theme</button>
    </form>
    </div>
    <div class="col-12 col-md-7">
      <iframe id="menuPreview" class="w-100 mb-3" src="/order" title="Menu preview"></iframe>
      <% if (stations && stations.length) { %>
      <iframe id="stationPreview" class="w-100" src="/station/<%= stations[0].id %>" title="Station preview"></iframe>
      <% } %>
      <div class="mt-2 text-end">
        <button type="button" id="togglePreview" class="btn btn-secondary btn-sm me-2">Hide Preview</button>
        <button type="button" id="resetPreview" class="btn btn-secondary btn-sm">Reset to Defaults</button>
      </div>
    </div>
  </div>
  </div>
<script>
  const themeForm = document.getElementById('themeForm');
  const themeToggle = document.querySelector('button[data-bs-target="#themeForm"]');
  if (themeForm && themeToggle) {
    const updateText = () => {
      themeToggle.textContent = themeForm.classList.contains('show') ? 'Hide Settings' : 'Show Settings';
    };
    updateText();
    themeForm.addEventListener('shown.bs.collapse', updateText);
    themeForm.addEventListener('hidden.bs.collapse', updateText);
  }
</script>
<script defer src="/themePreview.js"></script>
</div>
